<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Vault Low-Level Client — vault_api_client • vaultr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Vault Low-Level Client — vault_api_client" />
<meta property="og:description" content="Low-level API client.  This can be used to directly communicate
with the vault server.  This object will primarily be useful for
debugging, testing or developing new vault methods, but is
nonetheless described here." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vaultr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vaultr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/packages.html">Using vaultr in packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vimc/vaultr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Vault Low-Level Client</h1>
    <small class="dont-index">Source: <a href='https://github.com/vimc/vaultr/blob/master/R/vault_api_client.R'><code>R/vault_api_client.R</code></a></small>
    <div class="hidden name"><code>vault_api_client.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Low-level API client.  This can be used to directly communicate
with the vault server.  This object will primarily be useful for
debugging, testing or developing new vault methods, but is
nonetheless described here.</p>
    </div>



    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    


<dl>
<dt><code>is_authenticated</code></dt><dd><p>Test if the vault client currently holds a vault token.  This method does not verify the token - only test that is present.
  <br /><em>Usage:</em><pre><span class='fu'>is_authenticated</span><span class='op'>(</span><span class='op'>)</span></pre></p></dd>
<dt><code>set_token</code></dt><dd><p>Set a token within the client
  <br /><em>Usage:</em><pre><span class='fu'>set_token</span><span class='op'>(</span><span class='va'>token</span>, verify <span class='op'>=</span> <span class='cn'>FALSE</span>, quiet <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>token</code>:   String, with the new vault client token</p></li>
<li><p><code>verify</code>:   Logical, indicating if we should test that the token is valid. If <code>TRUE</code>, then we use <code>$verify_token()</code> to test the token before setting it and if it is not valid an error will be thrown and the token not set.</p></li>
<li><p><code>quiet</code>:   Logical, if <code>TRUE</code>, then informational messages will be suppressed.</p></li>
</ul></p></dd>
<dt><code>verify_token</code></dt><dd><p>Test that a token is valid with the vault.  This will call vault's <code>/sys/capabilities-self</code> endpoint with the token provided and check the <code>/sys</code> path.
  <br /><em>Usage:</em><pre><span class='fu'>verify_token</span><span class='op'>(</span><span class='va'>token</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>token</code>:   String, with the vault client token to test</p></li>
<li><p><code>quiet</code>:   Logical, if <code>TRUE</code>, then informational messages will be suppressed.</p></li>
</ul></p></dd>
<dt><code>server_version</code></dt><dd><p>Retrieve the vault server version.  This is by default cached within the client for a session.  Will return an R <code>numeric_version</code> object.
  <br /><em>Usage:</em><pre><span class='fu'>server_version</span><span class='op'>(</span>refresh <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>refresh</code>:   Logical, indicating if the server version information should be refreshed even if known.</p></li>
</ul></p></dd>
<dt><code>GET</code></dt><dd><p>Send a <code>GET</code> request to the vault server
  <br /><em>Usage:</em><pre><span class='fu'>GET</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>...</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>path</code>:   The server path to use.  This is the "interesting" part of the path only, with the server base url and api version information added.</p></li>
<li><p><code>...</code>:   Additional <code>httr</code>-compatible options.  These will be named parameters or <code>httr</code> "request" objects.</p></li>
</ul></p></dd>
<dt><code>LIST</code></dt><dd><p>Send a <code>LIST</code> request to the vault server
  <br /><em>Usage:</em><pre><span class='fu'>LIST</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>...</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>path</code>:   The server path to use.  This is the "interesting" part of the path only, with the server base url and api version information added.</p></li>
<li><p><code>...</code>:   Additional <code>httr</code>-compatible options.  These will be named parameters or <code>httr</code> "request" objects.</p></li>
</ul></p></dd>
<dt><code>POST</code></dt><dd><p>Send a <code>POST</code> request to the vault server
  <br /><em>Usage:</em><pre><span class='fu'>POST</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>...</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>path</code>:   The server path to use.  This is the "interesting" part of the path only, with the server base url and api version information added.</p></li>
<li><p><code>...</code>:   Additional <code>httr</code>-compatible options.  These will be named parameters or <code>httr</code> "request" objects.</p></li>
</ul></p></dd>
<dt><code>PUT</code></dt><dd><p>Send a <code>PUT</code> request to the vault server
  <br /><em>Usage:</em><pre><span class='fu'>PUT</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>...</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>path</code>:   The server path to use.  This is the "interesting" part of the path only, with the server base url and api version information added.</p></li>
<li><p><code>...</code>:   Additional <code>httr</code>-compatible options.  These will be named parameters or <code>httr</code> "request" objects.</p></li>
</ul></p></dd>
<dt><code>DELETE</code></dt><dd><p>Send a <code>DELETE</code> request to the vault server
  <br /><em>Usage:</em><pre><span class='fu'>DELETE</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>...</span><span class='op'>)</span></pre>  <em>Arguments:</em>
  <ul>
<li><p><code>path</code>:   The server path to use.  This is the "interesting" part of the path only, with the server base url and api version information added.</p></li>
<li><p><code>...</code>:   Additional <code>httr</code>-compatible options.  These will be named parameters or <code>httr</code> "request" objects.</p></li>
</ul></p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>server</span> <span class='op'>&lt;-</span> <span class='fu'>vaultr</span><span class='fu'>::</span><span class='fu'><a href='vault_test_server.html'>vault_test_server</a></span><span class='op'>(</span>if_disabled <span class='op'>=</span> <span class='va'>message</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>vault is not enabled</span></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>server</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># Ordinarily, we would use the "vault_client" object for</span>
  <span class='co'># high-level access to the vault server</span>
  <span class='va'>client</span> <span class='op'>&lt;-</span> <span class='va'>server</span><span class='op'>$</span><span class='fu'>client</span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>client</span><span class='op'>$</span><span class='fu'>status</span><span class='op'>(</span><span class='op'>)</span>

  <span class='co'># The api() method returns the "api client" object:</span>
  <span class='va'>api</span> <span class='op'>&lt;-</span> <span class='va'>client</span><span class='op'>$</span><span class='fu'>api</span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>api</span>

  <span class='co'># This allows running arbitrary HTTP requests against the server:</span>
  <span class='va'>api</span><span class='op'>$</span><span class='fu'>GET</span><span class='op'>(</span><span class='st'>"/sys/seal-status"</span><span class='op'>)</span>

  <span class='co'># this is how vaultr is internally implemented so anything can</span>
  <span class='co'># be done here, for example following vault's API documentation</span>
  <span class='co'># https://www.vaultproject.io/api/secret/kv/kv-v1.html#sample-request-2</span>
  <span class='va'>api</span><span class='op'>$</span><span class='fu'>POST</span><span class='op'>(</span><span class='st'>"/secret/mysecret"</span>, body <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>key <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>api</span><span class='op'>$</span><span class='fu'>GET</span><span class='op'>(</span><span class='st'>"/secret/mysecret"</span><span class='op'>)</span>
  <span class='va'>api</span><span class='op'>$</span><span class='fu'>DELETE</span><span class='op'>(</span><span class='st'>"/secret/mysecret"</span><span class='op'>)</span>

  <span class='co'># cleanup</span>
  <span class='va'>server</span><span class='op'>$</span><span class='fu'>kill</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn, Robert Ashton, Wes Hinsley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


