<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Transit Engine — vault_client_transit • vaultr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Transit Engine — vault_client_transit"><meta property="og:description" content="Transit Engine
Transit Engine"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vaultr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/vaultr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/packages.html">Using vaultr in packages</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vimc/vaultr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Transit Engine</h1>
    <small class="dont-index">Source: <a href="https://github.com/vimc/vaultr/blob/HEAD/R/vault_client_transit.R" class="external-link"><code>R/vault_client_transit.R</code></a></small>
    <div class="hidden name"><code>vault_client_transit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transit Engine</p>
<p>Transit Engine</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>Interact with vault's <code>transit</code> engine.  This is useful for
encrypting arbitrary data without storing it in the vault - like
"cryptography as a service" or "encryption as a service". The
transit secrets engine can also sign and verify data; generate
hashes and HMACs of data; and act as a source of random bytes.
See
https://www.vaultproject.io/docs/secrets/transit/index.html
for an introduction to the capabilities of the <code>transit</code>
engine.</p>
    </div>
    <div id="super-class">
    <h2>Super class</h2>
    <p><code><a href="vault_client_object.html">vaultr::vault_client_object</a></code> -&gt; <code>vault_client_transit</code></p>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-vault_client_transit-new"><code>vault_client_transit$new()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-custom_mount"><code>vault_client_transit$custom_mount()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_create"><code>vault_client_transit$key_create()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_read"><code>vault_client_transit$key_read()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_list"><code>vault_client_transit$key_list()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_delete"><code>vault_client_transit$key_delete()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_update"><code>vault_client_transit$key_update()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_rotate"><code>vault_client_transit$key_rotate()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_export"><code>vault_client_transit$key_export()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-data_encrypt"><code>vault_client_transit$data_encrypt()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-data_decrypt"><code>vault_client_transit$data_decrypt()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-data_rewrap"><code>vault_client_transit$data_rewrap()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-datakey_create"><code>vault_client_transit$datakey_create()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-random"><code>vault_client_transit$random()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-hash"><code>vault_client_transit$hash()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-hmac"><code>vault_client_transit$hmac()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-sign"><code>vault_client_transit$sign()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-verify_signature"><code>vault_client_transit$verify_signature()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-verify_hmac"><code>vault_client_transit$verify_hmac()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_backup"><code>vault_client_transit$key_backup()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_restore"><code>vault_client_transit$key_restore()</code></a></p></li>
<li><p><a href="#method-vault_client_transit-key_trim"><code>vault_client_transit$key_trim()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="vaultr" data-topic="vault_client_object" data-id="format"><a href="vault_client_object.html#method-format"><code>vaultr::vault_client_object$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="vaultr" data-topic="vault_client_object" data-id="help"><a href="vault_client_object.html#method-help"><code>vaultr::vault_client_object$help()</code></a></span></li>
</ul></details></p><hr><a id="method-vault_client_transit-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a <code>vault_client_transit</code> object. Not typically
called by users.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/vault_client_transit.html">vault_client_transit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">api_client</span>, <span class="va">mount</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>api_client</code></dt>
<dd><p>A <a href="vault_api_client.html">vault_api_client</a> object</p></dd>


<dt><code>mount</code></dt>
<dd><p>Mount point for the backend</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-custom_mount"></a><div class="section">
<h3 id="method-custom-mount-">Method <code>custom_mount()</code><a class="anchor" aria-label="anchor" href="#method-custom-mount-"></a></h3>
<p>Set up a <code>vault_client_transit</code> object at a custom
mount.  For example, suppose you mounted the <code>transit</code> secret
backend at <code>/transit2</code> you might use <code>tr &lt;- vault$secrets$transit$custom_mount("/transit2")</code> - this
pattern is repeated for other secret and authentication
backends.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">custom_mount</span><span class="op">(</span><span class="va">mount</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>mount</code></dt>
<dd><p>String, indicating the path that the engine is
mounted at.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_create"></a><div class="section">
<h3 id="method-key-create-">Method <code>key_create()</code><a class="anchor" aria-label="anchor" href="#method-key-create-"></a></h3>
<p>Create a new named encryption key of the specified
type. The values set here cannot be changed after key
creation.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_create</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  key_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convergent_encryption <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  derived <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exportable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  allow_plaintext_backup <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name for the key.  This will be used in all future
interactions with the key - the key itself is not returned.</p></dd>


<dt><code>key_type</code></dt>
<dd><p>Specifies the type of key to create.  The default is
<code>aes256-gcm96</code>. The currently-supported types are:</p><ul><li><p><code>aes256-gcm96</code>: AES-256 wrapped with GCM using a 96-bit nonce
size AEAD (symmetric, supports derivation and convergent
encryption)</p></li>
<li><p><code>chacha20-poly1305</code>: ChaCha20-Poly1305 AEAD (symmetric,
supports derivation and convergent encryption)</p></li>
<li><p><code>ed25519</code>: ED25519 (asymmetric, supports derivation). When
using derivation, a sign operation with the same context will
derive the same key and signature; this is a signing analogue
to <code>convergent_encryption</code></p></li>
<li><p><code>ecdsa-p256</code>: ECDSA using the P-256 elliptic curve
(asymmetric)</p></li>
<li><p><code>rsa-2048</code>: RSA with bit size of 2048 (asymmetric)</p></li>
<li><p><code>rsa-4096</code>: RSA with bit size of 4096 (asymmetric)</p></li>
</ul></dd>


<dt><code>convergent_encryption</code></dt>
<dd><p>Logical with default of <code>FALSE</code>.
If <code>TRUE</code>, then the key will support convergent encryption,
where the same plaintext creates the same ciphertext. This
requires derived to be set to true. When enabled, each
encryption(/decryption/rewrap/datakey) operation will derive
a <code>nonce</code> value rather than randomly generate it.</p></dd>


<dt><code>derived</code></dt>
<dd><p>Specifies if key derivation is to be used. If
enabled, all encrypt/decrypt requests to this named key must
provide a context which is used for key derivation (default
is <code>FALSE</code>).</p></dd>


<dt><code>exportable</code></dt>
<dd><p>Enables keys to be exportable. This allows
for all the valid keys in the key ring to be exported. Once
set, this cannot be disabled (default is <code>FALSE</code>).</p></dd>


<dt><code>allow_plaintext_backup</code></dt>
<dd><p>If set, enables taking backup of
named key in the plaintext format. Once set, this cannot be
disabled (default is <code>FALSE</code>).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_read"></a><div class="section">
<h3 id="method-key-read-">Method <code>key_read()</code><a class="anchor" aria-label="anchor" href="#method-key-read-"></a></h3>
<p>Read information about a previously generated key.
The returned object shows the creation time of each key
version; the values are not the keys themselves. Depending on
the type of key, different information may be returned,
e.g. an asymmetric key will return its public key in a
standard format for the type.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_read</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the key to read</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_list"></a><div class="section">
<h3 id="method-key-list-">Method <code>key_list()</code><a class="anchor" aria-label="anchor" href="#method-key-list-"></a></h3>
<p>List names of all keys</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_list</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-vault_client_transit-key_delete"></a><div class="section">
<h3 id="method-key-delete-">Method <code>key_delete()</code><a class="anchor" aria-label="anchor" href="#method-key-delete-"></a></h3>
<p>Delete a key by name.  It will no longer be
possible to decrypt any data encrypted with the named
key. Because this is a potentially catastrophic operation,
the <code>deletion_allowed</code> tunable must be set using
<code>$key_update()</code>.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_delete</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the key to delete.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_update"></a><div class="section">
<h3 id="method-key-update-">Method <code>key_update()</code><a class="anchor" aria-label="anchor" href="#method-key-update-"></a></h3>
<p>This method allows tuning configuration values for
a given key. (These values are returned during a read
operation on the named key.)</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_update</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  min_decryption_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_encryption_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  deletion_allowed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exportable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  allow_plaintext_backup <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the key to update</p></dd>


<dt><code>min_decryption_version</code></dt>
<dd><p>Specifies the minimum version of
ciphertext allowed to be decrypted, as an integer (default is
<code>0</code>). Adjusting this as part of a key rotation policy can
prevent old copies of ciphertext from being decrypted, should
they fall into the wrong hands. For signatures, this value
controls the minimum version of signature that can be
verified against. For HMACs, this controls the minimum
version of a key allowed to be used as the key for
verification.</p></dd>


<dt><code>min_encryption_version</code></dt>
<dd><p>Specifies the minimum version of
the key that can be used to encrypt plaintext, sign payloads,
or generate HMACs, as an integer (default is <code>0</code>).  Must be 0
(which will use the latest version) or a value greater or
equal to <code>min_decryption_version</code>.</p></dd>


<dt><code>deletion_allowed</code></dt>
<dd><p>Specifies if the key is allowed to be
deleted, as a logical (default is <code>FALSE</code>).</p></dd>


<dt><code>exportable</code></dt>
<dd><p>Enables keys to be exportable. This allows
for all the valid keys in the key ring to be exported. Once
set, this cannot be disabled.</p></dd>


<dt><code>allow_plaintext_backup</code></dt>
<dd><p>If set, enables taking backup of
named key in the plaintext format. Once set, this cannot be
disabled.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_rotate"></a><div class="section">
<h3 id="method-key-rotate-">Method <code>key_rotate()</code><a class="anchor" aria-label="anchor" href="#method-key-rotate-"></a></h3>
<p>Rotates the version of the named key. After
rotation, new plaintext requests will be encrypted with the
new version of the key. To upgrade ciphertext to be encrypted
with the latest version of the key, use the rewrap
endpoint. This is only supported with keys that support
encryption and decryption operations.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_rotate</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the key to rotate</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_export"></a><div class="section">
<h3 id="method-key-export-">Method <code>key_export()</code><a class="anchor" aria-label="anchor" href="#method-key-export-"></a></h3>
<p>Export the named key. If version is specified, the
specific version will be returned. If latest is provided as
the version, the current key will be provided. Depending on
the type of key, different information may be returned. The
key must be exportable to support this operation and the
version must still be valid.</p>
<p>For more details see
https://github.com/hashicorp/vault/issues/2667 where
HashiCorp says "Part of the "contract" of transit is that the
key is never exposed outside of Vault. We added the ability
to export keys because some enterprises have key escrow
requirements, but it leaves a permanent mark in the key
metadata. I suppose we could at some point allow importing a
key and also leave such a mark."</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_export</span><span class="op">(</span><span class="va">name</span>, <span class="va">key_type</span>, version <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name of the key to export</p></dd>


<dt><code>key_type</code></dt>
<dd><p>Specifies the type of the key to export. Valid
values are <code>encryption-key</code>, <code>signing-key</code> and <code>hmac-key</code>.</p></dd>


<dt><code>version</code></dt>
<dd><p>Specifies the version of the key to read. If
omitted, all versions of the key will be returned. If the
version is set to latest, the current key will be returned</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-data_encrypt"></a><div class="section">
<h3 id="method-data-encrypt-">Method <code>data_encrypt()</code><a class="anchor" aria-label="anchor" href="#method-data-encrypt-"></a></h3>
<p>This endpoint encrypts the provided plaintext
using the named key.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">data_encrypt</span><span class="op">(</span></span>
<span>  <span class="va">key_name</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  key_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  context <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>key_name</code></dt>
<dd><p>Specifies the name of the encryption key to
encrypt against.</p></dd>


<dt><code>data</code></dt>
<dd><p>Data to encrypt, as a raw vector</p></dd>


<dt><code>key_version</code></dt>
<dd><p>Key version to use, as an integer. If not
set, uses the latest version. Must be greater than or equal
to the key's <code>min_encryption_version</code>, if set.</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-data_decrypt"></a><div class="section">
<h3 id="method-data-decrypt-">Method <code>data_decrypt()</code><a class="anchor" aria-label="anchor" href="#method-data-decrypt-"></a></h3>
<p>Decrypts the provided ciphertext using the named
key.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">data_decrypt</span><span class="op">(</span><span class="va">key_name</span>, <span class="va">data</span>, context <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>key_name</code></dt>
<dd><p>Specifies the name of the encryption key to
decrypt with.</p></dd>


<dt><code>data</code></dt>
<dd><p>The data to decrypt.  Must be a string, as returned
by <code>$data_encrypt</code>.</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-data_rewrap"></a><div class="section">
<h3 id="method-data-rewrap-">Method <code>data_rewrap()</code><a class="anchor" aria-label="anchor" href="#method-data-rewrap-"></a></h3>
<p>Rewraps the provided ciphertext using the latest
version of the named key. Because this never returns
plaintext, it is possible to delegate this functionality to
untrusted users or scripts.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">data_rewrap</span><span class="op">(</span></span>
<span>  <span class="va">key_name</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  key_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  context <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>key_name</code></dt>
<dd><p>Specifies the name of the encryption key to
re-encrypt against</p></dd>


<dt><code>data</code></dt>
<dd><p>The data to decrypt.  Must be a string, as returned
by <code>$data_encrypt</code>.</p></dd>


<dt><code>key_version</code></dt>
<dd><p>Specifies the version of the key to use for
the operation. If not set, uses the latest version. Must be
greater than or equal to the key's <code>min_encryption_version</code>,
if set.</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-datakey_create"></a><div class="section">
<h3 id="method-datakey-create-">Method <code>datakey_create()</code><a class="anchor" aria-label="anchor" href="#method-datakey-create-"></a></h3>
<p>This endpoint generates a new high-entropy key and
the value encrypted with the named key. Optionally return the
plaintext of the key as well.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">datakey_create</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  plaintext <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  context <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Specifies the name of the encryption key to use to
encrypt the datakey</p></dd>


<dt><code>plaintext</code></dt>
<dd><p>Logical, indicating if the plaintext key
should be returned.</p></dd>


<dt><code>bits</code></dt>
<dd><p>Specifies the number of bits in the desired
key. Can be 128, 256, or 512.</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-random"></a><div class="section">
<h3 id="method-random-">Method <code>random()</code><a class="anchor" aria-label="anchor" href="#method-random-"></a></h3>
<p>Generates high-quality random bytes of the
specified length.  This is totally independent of R's random
number stream and provides random numbers suitable for
cryptographic purposes.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">random</span><span class="op">(</span>bytes <span class="op">=</span> <span class="fl">32</span>, format <span class="op">=</span> <span class="st">"hex"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>bytes</code></dt>
<dd><p>Number of bytes to generate (as an integer)</p></dd>


<dt><code>format</code></dt>
<dd><p>The output format to produce; must be one of
<code>hex</code> (a single hex string such as <code>d1189e2f83b72ab6</code>),
<code>base64</code> (a single base64 encoded string such as
<code>8TDJekY0mYs=</code>) or <code>raw</code> (a raw vector of length <code>bytes</code>).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-hash"></a><div class="section">
<h3 id="method-hash-">Method <code>hash()</code><a class="anchor" aria-label="anchor" href="#method-hash-"></a></h3>
<p>Generates a cryptographic hash of given data using
the specified algorithm.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">hash</span><span class="op">(</span><span class="va">data</span>, algorithm <span class="op">=</span> <span class="cn">NULL</span>, format <span class="op">=</span> <span class="st">"hex"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>A raw vector of data to hash.  To generate a raw
vector from an R object, one option is to use <code>unserialize(x, NULL)</code> but be aware that version information may be included.
Alternatively, for a string, one might use <code>charToRaw</code>.</p></dd>


<dt><code>algorithm</code></dt>
<dd><p>A string indicating the hash algorithm to use.
The exact set of supported algorithms may depend by vault
server version, but as of version 1.0.0 vault supports
<code>sha2-224</code>, <code>sha2-256</code>, <code>sha2-384</code> and <code>sha2-512</code>.  The
default is <code>sha2-256</code>.</p></dd>


<dt><code>format</code></dt>
<dd><p>The format of the output - must be one of <code>hex</code>
or <code>base64</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-hmac"></a><div class="section">
<h3 id="method-hmac-">Method <code>hmac()</code><a class="anchor" aria-label="anchor" href="#method-hmac-"></a></h3>
<p>This endpoint returns the digest of given data
using the specified hash algorithm and the named key. The key
can be of any type supported by the <code>transit</code> engine; the raw
key will be marshalled into bytes to be used for the HMAC
function. If the key is of a type that supports rotation, the
latest (current) version will be used.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">hmac</span><span class="op">(</span><span class="va">name</span>, <span class="va">data</span>, key_version <span class="op">=</span> <span class="cn">NULL</span>, algorithm <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Specifies the name of the encryption key to
generate hmac against</p></dd>


<dt><code>data</code></dt>
<dd><p>The input data, as a raw vector</p></dd>


<dt><code>key_version</code></dt>
<dd><p>Specifies the version of the key to use for
the operation. If not set, uses the latest version. Must be
greater than or equal to the key's <code>min_encryption_version</code>,
if set.</p></dd>


<dt><code>algorithm</code></dt>
<dd><p>Specifies the hash algorithm to
use. Currently-supported algorithms are <code>sha2-224</code>,
<code>sha2-256</code>, <code>sha2-384</code> and <code>sha2-512</code>.  The default is
<code>sha2-256</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-sign"></a><div class="section">
<h3 id="method-sign-">Method <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign()</a></code><a class="anchor" aria-label="anchor" href="#method-sign-"></a></h3>
<p>Returns the cryptographic signature of the given
data using the named key and the specified hash
algorithm. The key must be of a type that supports signing.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">sign</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  key_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hash_algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prehashed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  signature_algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  context <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Specifies the name of the encryption key to use for
signing</p></dd>


<dt><code>data</code></dt>
<dd><p>The input data, as a raw vector</p></dd>


<dt><code>key_version</code></dt>
<dd><p>Specifies the version of the key to use for
signing. If not set, uses the latest version. Must be greater
than or equal to the key's <code>min_encryption_version</code>, if set.</p></dd>


<dt><code>hash_algorithm</code></dt>
<dd><p>Specifies the hash algorithm to
use. Currently-supported algorithms are <code>sha2-224</code>,
<code>sha2-256</code>, <code>sha2-384</code> and <code>sha2-512</code>.  The default is
<code>sha2-256</code>.</p></dd>


<dt><code>prehashed</code></dt>
<dd><p>Set to true when the input is already
hashed. If the key type is <code>rsa-2048</code> or <code>rsa-4096</code>, then the
algorithm used to hash the input should be indicated by the
<code>hash_algorithm</code> parameter.</p></dd>


<dt><code>signature_algorithm</code></dt>
<dd><p>When using a RSA key, specifies the
RSA signature algorithm to use for signing. Supported
signature types are <code>pss</code> (the default) and <code>pkcs1v15</code>.</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-verify_signature"></a><div class="section">
<h3 id="method-verify-signature-">Method <code>verify_signature()</code><a class="anchor" aria-label="anchor" href="#method-verify-signature-"></a></h3>
<p>Determine whether the provided signature is valid
for the given data.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">verify_signature</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">signature</span>,</span>
<span>  hash_algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  signature_algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  context <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prehashed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-16">Arguments<a class="anchor" aria-label="anchor" href="#arguments-16"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name of the key</p></dd>


<dt><code>data</code></dt>
<dd><p>Data to verify, as a raw vector</p></dd>


<dt><code>signature</code></dt>
<dd><p>The signed data, as a string.</p></dd>


<dt><code>hash_algorithm</code></dt>
<dd><p>Specifies the hash algorithm to use. This
can also be specified as part of the URL (see <code>$sign</code> and
<code>$hmac</code> for details).</p></dd>


<dt><code>signature_algorithm</code></dt>
<dd><p>When using a RSA key, specifies the
RSA signature algorithm to use for signature verification</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


<dt><code>prehashed</code></dt>
<dd><p>Set to <code>TRUE</code> when the input is already hashed</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-verify_hmac"></a><div class="section">
<h3 id="method-verify-hmac-">Method <code>verify_hmac()</code><a class="anchor" aria-label="anchor" href="#method-verify-hmac-"></a></h3>
<p>Determine whether the provided signature is valid
for the given data.</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">verify_hmac</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">signature</span>,</span>
<span>  hash_algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  signature_algorithm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  context <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prehashed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-17">Arguments<a class="anchor" aria-label="anchor" href="#arguments-17"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name of the key</p></dd>


<dt><code>data</code></dt>
<dd><p>Data to verify, as a raw vector</p></dd>


<dt><code>signature</code></dt>
<dd><p>The signed data, as a string.</p></dd>


<dt><code>hash_algorithm</code></dt>
<dd><p>Specifies the hash algorithm to use. This
can also be specified as part of the URL (see <code>$sign</code> and
<code>$hmac</code> for details).</p></dd>


<dt><code>signature_algorithm</code></dt>
<dd><p>When using a RSA key, specifies the
RSA signature algorithm to use for signature verification</p></dd>


<dt><code>context</code></dt>
<dd><p>Specifies the context for key derivation. This
is required if key derivation is enabled for this key.  Must
be a raw vector.</p></dd>


<dt><code>prehashed</code></dt>
<dd><p>Set to <code>TRUE</code> when the input is already hashed</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_backup"></a><div class="section">
<h3 id="method-key-backup-">Method <code>key_backup()</code><a class="anchor" aria-label="anchor" href="#method-key-backup-"></a></h3>
<p>Returns a plaintext backup of a named key. The
backup contains all the configuration data and keys of all
the versions along with the HMAC key. The response from this
endpoint can be used with <code>$key_restore</code> to restore the key.</p><div class="section">
<h4 id="usage-19">Usage<a class="anchor" aria-label="anchor" href="#usage-19"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_backup</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-18">Arguments<a class="anchor" aria-label="anchor" href="#arguments-18"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name of the key to backup</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_restore"></a><div class="section">
<h3 id="method-key-restore-">Method <code>key_restore()</code><a class="anchor" aria-label="anchor" href="#method-key-restore-"></a></h3>
<p>Restores the backup as a named key. This will
restore the key configurations and all the versions of the
named key along with HMAC keys. The input to this method
should be the output of <code>$key_restore</code> method.</p><div class="section">
<h4 id="usage-20">Usage<a class="anchor" aria-label="anchor" href="#usage-20"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_restore</span><span class="op">(</span><span class="va">name</span>, <span class="va">backup</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-19">Arguments<a class="anchor" aria-label="anchor" href="#arguments-19"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Name of the restored key.</p></dd>


<dt><code>backup</code></dt>
<dd><p>Backed up key data to be restored. This should be
the output from the <code>$key_backup</code> endpoint.</p></dd>


<dt><code>force</code></dt>
<dd><p>Logical.  If <code>TRUE</code>, then force the restore to
proceed even if a key by this name already exists.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-vault_client_transit-key_trim"></a><div class="section">
<h3 id="method-key-trim-">Method <code>key_trim()</code><a class="anchor" aria-label="anchor" href="#method-key-trim-"></a></h3>
<p>This endpoint trims older key versions setting a
minimum version for the keyring. Once trimmed, previous
versions of the key cannot be recovered.</p><div class="section">
<h4 id="usage-21">Usage<a class="anchor" aria-label="anchor" href="#usage-21"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">vault_client_transit</span><span class="op">$</span><span class="fu">key_trim</span><span class="op">(</span><span class="va">name</span>, <span class="va">min_version</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-20">Arguments<a class="anchor" aria-label="anchor" href="#arguments-20"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Key to trim</p></dd>


<dt><code>min_version</code></dt>
<dd><p>The minimum version for the key ring. All
versions before this version will be permanently
deleted. This value can at most be equal to the lesser of
<code>min_decryption_version</code> and <code>min_encryption_version</code>. This
is not allowed to be set when either <code>min_encryption_version</code>
or <code>min_decryption_version</code> is set to zero.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">server</span> <span class="op">&lt;-</span> <span class="fu">vaultr</span><span class="fu">::</span><span class="fu"><a href="vault_test_server.html">vault_test_server</a></span><span class="op">(</span>if_disabled <span class="op">=</span> <span class="va">message</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ...waiting for Vault to start</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">server</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">client</span> <span class="op">&lt;-</span> <span class="va">server</span><span class="op">$</span><span class="fu">client</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">client</span><span class="op">$</span><span class="va">secrets</span><span class="op">$</span><span class="fu">enable</span><span class="op">(</span><span class="st">"transit"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">transit</span> <span class="op">&lt;-</span> <span class="va">client</span><span class="op">$</span><span class="va">secrets</span><span class="op">$</span><span class="va">transit</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Before encrypting anything, create a key.  Note that it will</span></span></span>
<span class="r-in"><span>  <span class="co"># not be returned to you, and is accessed purely by name</span></span></span>
<span class="r-in"><span>  <span class="va">transit</span><span class="op">$</span><span class="fu">key_create</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Some text to encrypt</span></span></span>
<span class="r-in"><span>  <span class="va">plaintext</span> <span class="op">&lt;-</span> <span class="st">"hello world"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Encrypted:</span></span></span>
<span class="r-in"><span>  <span class="va">cyphertext</span> <span class="op">&lt;-</span> <span class="va">transit</span><span class="op">$</span><span class="fu">data_encrypt</span><span class="op">(</span><span class="st">"test"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="va">plaintext</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Decrypt the data</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">transit</span><span class="op">$</span><span class="fu">data_decrypt</span><span class="op">(</span><span class="st">"test"</span>, <span class="va">cyphertext</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">rawToChar</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># This approach works with R objects too, if used with serialise.</span></span></span>
<span class="r-in"><span>  <span class="co"># First, serialise an R object to a raw vector:</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Then encrypt this data:</span></span></span>
<span class="r-in"><span>  <span class="va">enc</span> <span class="op">&lt;-</span> <span class="va">transit</span><span class="op">$</span><span class="fu">data_encrypt</span><span class="op">(</span><span class="st">"test"</span>, <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The resulting string can be safely passed around (e.g., over</span></span></span>
<span class="r-in"><span>  <span class="co"># email) or written to disk, and can later be decrypted by</span></span></span>
<span class="r-in"><span>  <span class="co"># anyone who has access to the "test" key in the vault:</span></span></span>
<span class="r-in"><span>  <span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">transit</span><span class="op">$</span><span class="fu">data_decrypt</span><span class="op">(</span><span class="st">"test"</span>, <span class="va">enc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Once decrypted, the data can be "unserialised" back into an R</span></span></span>
<span class="r-in"><span>  <span class="co"># object:</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">unserialize</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># cleanup</span></span></span>
<span class="r-in"><span>  <span class="va">server</span><span class="op">$</span><span class="fu">kill</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rich FitzJohn, Robert Ashton, Wes Hinsley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

